!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","d3","lodash"],t):t(e.wb={},e.d3,e._)}(this,function(e,d,o){"use strict";o=o&&o.hasOwnProperty("default")?o.default:o;var n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),l=function(e){return Array.isArray(e)?e:Array.from(e)};function f(o,e,t){var c=t.targetField;return e.reduce(function(e,t){var n,r=o.getValueByName(t,c).split("/"),a=l(r),i=a[0],u=a.slice(1);return e.name=(n=i)?(n=n.slice(0,n.length-1)).split(",").reverse().join("."):n,function e(t,n){if(n&&0!==n.length){var r=l(n),a=r[0],i=r.slice(1);if(a){var u=void 0;t.children?u=t.children.filter(function(e){return e.name===a})[0]:t.children=[],u||(u={name:a},t.children.push(u)),e(u,i)}}}(e,u),e},{})}var p=function(){function t(e){n(this,t),this.fields=e[0],this.getIndexByName=o.memoize(this.getIndexByName)}return r(t,[{key:"getIndexByName",value:function(e){return this.fields.indexOf(e)}},{key:"getValueByName",value:function(e,t){return e[this.getIndexByName(t)]}}]),t}();var s=d.arc().startAngle(function(e){return e.x0}).endAngle(function(e){return e.x1}).innerRadius(function(e){return Math.sqrt(e.y0)}).outerRadius(function(e){return Math.sqrt(e.y1)}),y=d.scaleOrdinal(d.schemeCategory20b);function v(i,r,e,a,u,t){var n=d.partition().size([2*Math.PI,e*e])(d.hierarchy({children:[t]}).sum(function(e){return!e.children}).sort(function(e,t){return t.value-e.value})).descendants();function o(e){for(var t=e.ancestors().reverse(),n="",r=1;r<t.length&&"end"!==t[r].data.name;r++)n=n+"/"+t[r].data.name;return a+"/web/"+u+"0630"+n}function c(e){var t=e.ancestors().reverse();t.shift();var n=o(e);!function(e,t){var n="",r=document.createElement("span");r.setAttribute("class","symb"),r.innerHTML="/";for(var a=0;a<e.length;a++)n=0===a?" "+e[a].data.name:n+r.innerHTML+e[a].data.name;n=decodeURIComponent(n),i.querySelector(".sequence").innerHTML='<a href="'+t+'">'+n+"</a>"}(t,n),d.selectAll("path").style("opacity",.3),r.selectAll("path").filter(function(e){return 0<=t.indexOf(e)}).style("opacity",1)}r.selectAll("path").data(n).enter().append("a").attr("xlink:href",o).on("touchstart",function(e){return d.event.preventDefault(),d.event.stopPropagation(),c(e),!1}).append("svg:path").attr("display",function(e){return e.depth?null:"none"}).attr("d",s).attr("fill-rule","evenodd").style("fill",function(e){return y((e.children?e:e.parent).data.name)}).style("opacity",1).style("cursor","pointer").on("mouseover",c),d.select("#d3_container").on("mouseleave",function(){i.querySelector(".sequence").innerHTML="",d.selectAll("path").on("mouseover",null),d.selectAll("path").transition().style("opacity",1).on("end",function(){d.select(this).on("mouseover",c)})})}function u(e,t,n){var r=e.querySelector(".div-btn");r.onclick=function(e){return n(e.target.id)},e.querySelector(".year-btn")||t.forEach(function(e){return r.appendChild((t=e,(n=document.createElement("button")).setAttribute("class","year-btn"),n.setAttribute("id",t),n.innerHTML=t,n));var t,n})}e.RadialTree=function(n,e){var c=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).baseURL||"https://web.archive.org",t=function(){var e=document.createElement("div");e.setAttribute("class","rt-content");var t=document.createElement("div");t.setAttribute("class","div-btn");var n=document.createElement("p");n.setAttribute("class","sequence");var r=document.createElement("div");return r.setAttribute("id","chart"),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.style.display="block",e}();n.appendChild(t);var r,l=new p(e),s=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.groupBy,a=t.dedupBy,n=t.orderBy;if(!e)return e;var i=new p(e),u=e.slice(1).reduce(function(e,t){var n=e[i.getValueByName(t,r)]||{};return n[i.getValueByName(t,a)]||(n[i.getValueByName(t,a)]=t),e[i.getValueByName(t,r)]=n,e},{});return o(u).mapValues(function(e){return Object.values(e)}).mapValues(function(e){return o.sortBy(e,i.getIndexByName(n))}).value()}(e,{groupBy:"timestamp:4",dedupBy:"urlkey",orderBy:"urlkey"}),a=(r=s)?Object.keys(r).map(function(e){return Number.parseInt(e)}).sort():r;function i(e){var t;n.querySelector(".active-btn")&&n.querySelector(".active-btn").classList.remove("active-btn"),(t=e,n.ownerDocument.getElementById(t)).classList.add("active-btn"),function(e,t){e.querySelector(".sequence").innerHTML="",e.querySelector("#chart").innerHTML="";var n=e.querySelector("#chart").offsetWidth,r=n,a=Math.min(n,r)/2,i=d.select("#chart").append("svg:svg").attr("width",n).attr("height",r).append("svg:g").attr("id","d3_container").attr("transform","translate("+n/2+","+r/2+")");i.append("svg:circle").attr("r",a).style("opacity",0);var u=s[t],o=f(l,u,{targetField:"urlkey"});v(e,i,a,c,t,o)}(n,e)}u(n,a,i),i(a[a.length-2]||a[0])},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=radial-tree.umd.js.map
